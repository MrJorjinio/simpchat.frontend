import{a as s}from"./index-aMm9MGvC.js";import"./vendor-BPkUhSj7.js";import"./ui-BkpBpnHc.js";const l={getNotifications:async()=>{try{console.log("[NotificationService] Fetching notifications from GET /notifications");const e=await s.get("/notifications");console.log("[NotificationService] Raw API Response:",{status:e.status,statusText:e.statusText,data:e.data});let t=[];e.data?.success&&e.data?.data?(t=e.data.data,console.log("[NotificationService] Got notifications from response.data.data:",t.length,"items")):e.data&&Array.isArray(e.data)?(t=e.data,console.log("[NotificationService] Response is direct array:",t.length,"items")):(console.log("[NotificationService] Unexpected response format:",e.data),t=[]);const o=Array.isArray(t)?t.map(a=>({id:a.notificationId||a.id,chatId:a.chatId,messageId:a.messageId,chatName:a.chatName||"",chatAvatar:a.chatAvatar||"",senderName:a.senderName||"",content:a.content||"",fileUrl:a.fileUrl,sentTime:a.sentTime||new Date().toISOString(),seen:a.seen!==void 0?a.seen:!1})):[];return console.log("[NotificationService] Returning",o.length,"normalized notifications"),o}catch(e){return console.error("[NotificationService] Failed to fetch notifications:",e.message),console.error("[NotificationService] Error details:",{status:e.response?.status,statusText:e.response?.statusText,data:e.response?.data,url:e.config?.url}),[]}},markAsSeen:async e=>{try{console.log("[NotificationService] Marking notification as seen:",e);const t=await s.put(`/notifications/seen?notificationId=${e}`);return console.log("[NotificationService] Mark as seen response:",t.data),t.data?.data||t.data}catch(t){throw console.error("[NotificationService] Failed to mark notification as seen:",t),console.error("[NotificationService] Error details:",{status:t.response?.status,statusText:t.response?.statusText,data:t.response?.data}),t}},markMultipleAsSeen:async e=>{try{if(!Array.isArray(e)||e.length===0)return console.warn("[NotificationService] No notification IDs provided"),{success:!0};console.log("[NotificationService] Marking multiple notifications as seen:",e),console.log("[NotificationService] Notification IDs (type, count):",typeof e[0],e.length);const t={notificationIds:e};console.log("[NotificationService] Request body:",JSON.stringify(t));const o=await s.put("/notifications/seen/batch",t);return console.log("[NotificationService] Mark multiple response:",{status:o.status,statusText:o.statusText,data:o.data}),o.data?.success||o.status===200?(console.log("[NotificationService] Successfully marked",e.length,"notifications as seen"),o.data||{success:!0}):(console.warn("[NotificationService] Response indicates potential issue:",o.data),o.data||{success:!0})}catch(t){throw console.error("[NotificationService] Failed to mark multiple notifications as seen:",t),console.error("[NotificationService] Full error details:",{message:t.message,status:t.response?.status,statusText:t.response?.statusText,responseData:t.response?.data,requestData:t.config?.data,headers:t.config?.headers}),t}},markAllAsSeen:async()=>{try{const e=await s.put("/notifications/seen/all");return e.data?.data||e.data}catch(e){throw console.warn("[NotificationService] PUT /notifications/seen/all may not be implemented:",e),e}}};export{l as notificationService};
